\documentclass[a4paper, openright, twoside]{report}
\usepackage[utf8]{inputenc}
\usepackage[main=american]{babel}
\usepackage{hyphenat}
\usepackage[activate={true,nocompatibility}, final, tracking=true, kerning=true, factor=1100, stretch=10, shrink=10]{microtype}
% Prevent hyphenization
\tolerance=1
\emergencystretch=\maxdimen
\hyphenpenalty=10000
\hbadness=10000

\usepackage[hmarginratio=1:1,textwidth=360pt,textheight=595.8pt]{geometry}
% Packages
\usepackage{import}

% Math
\newcommand\hmmax{0}
\newcommand\bmmax{0}
\usepackage{bm}
\usepackage{amsmath, amsfonts, amssymb, mathrsfs,extarrows}
\usepackage{upgreek}
\usepackage{commath}
\usepackage[retainorgcmds]{IEEEtrantools}
\usepackage{siunitx}
\sisetup{%
  print-unity-mantissa=false,
  % exponent-mode=engineering,
  range-phrase = {\ \linebreak[0]\text{to}\ \nolinebreak},
  list-separator = {\text{, }},
  list-final-separator = {,\ \linebreak[0]\text{and }},
  list-pair-separator = {\ \text{and}\ },
  list-separator = {,\ \linebreak[0]}
  }%
\usepackage{multirow}
\usepackage[widespace]{fourier}

% Tables
\usepackage{array}
\usepackage{caption}
\usepackage[figuresright]{rotating}
\usepackage{multirow}
\usepackage{makecell}
\usepackage{footnote}
\usepackage{booktabs}
\usepackage{lscape}
\makesavenoteenv{tabular}

% Algorithm
\usepackage[chapter]{algorithm}
\usepackage{algpseudocode}

%% Citations
\usepackage[numbers]{natbib}
\bibliographystyle{plainnat}
\citestyle{egu}
\usepackage[hyphens]{url}
% Bibliography showing in TOC
% \usepackage[nottoc,numbib]{tocbibind}
\usepackage[nottoc]{tocbibind}
\usepackage{scrlayer}
\DeclareNewLayer[
    foreground,
    %textarea,% use only the textarea
    contents={%
      \parbox[b][\layerheight][c]{\layerwidth}
        {\centering Page intentionally left blank.}%
    }
  ]{blankpage.fg}
\DeclarePageStyleByLayers{blank}{blankpage.fg}

% Control structures
\usepackage{ifthen}

% Listing
\usepackage{listings}
\usepackage[table,dvipsnames]{xcolor}
\usepackage{float}

% Review notes:
\usepackage{xargs}
\usepackage[textwidth=30mm,textsize=footnotesize]{todonotes} % to create comments (useful to your advisor!)
\newcommandx{\bpf}[2][1=]{\todo[linecolor=blue,backgroundcolor=blue!25,bordercolor=blue,#1]{#2}} % Bernardo notes
\newcommandx{\jvc}[2][1=]{\todo[linecolor=orange,backgroundcolor=orange!25,bordercolor=orange,#1]{#2}} % My notes

% Equation color background
\usepackage{mdframed}

\newmdenv[
    hidealllines=true,
    backgroundcolor=black!20,
    skipbelow=\baselineskip,
    skipabove=\baselineskip
]{highlight}

\newcounter{problem}[chapter]\setcounter{problem}{1}
\renewcommand{\theproblem}{\arabic{chapter}.\arabic{problem}}
\newenvironment{problem}[2][]{%
    \refstepcounter{problem}

    \mdfsetup{hidealllines=true,
    backgroundcolor=black!20,
    skipbelow=\baselineskip,
    skipabove=\baselineskip,
    frametitle={Problem~\theproblem~|~#1}}

\begin{mdframed}[]\relax}{%
\end{mdframed}}

\newcounter{remark}[chapter]\setcounter{remark}{1}
\renewcommand{\theremark}{\arabic{chapter}.\arabic{remark}}
\newenvironment{remark}[2][]{%
    \refstepcounter{remark}

    \mdfsetup{hidealllines=true,
    backgroundcolor=black!20,
    skipbelow=\baselineskip,
    skipabove=\baselineskip,
    frametitle={Remark~\theremark~|~#1}}

\begin{mdframed}[]\relax}{%
\end{mdframed}}

% Enumeration
\usepackage{enumerate}


% Images
\usepackage[labelformat=simple]{subcaption}
\renewcommand\thesubfigure{(\alph{subfigure})}
\renewcommand\thesubtable{(\alph{subtable})}
\usepackage{graphicx}
\graphicspath{ {figures/} }
\usepackage{array}
\usepackage[section]{placeins}
\usepackage{color}
% \usepackage{subcaption}
% \usepackage{subfig}



% Images SVG
\usepackage{import}
\usepackage{xifthen}
\usepackage{pdfpages}
\usepackage{transparent}

\newcommand{\incfig}[1]{
    \def\svgwidth{0.3\columnwidth}
    \import{images/studies/minkowski/fundamental_forms_2D/}{#1.pdf_tex}}


% Floating environment for listings
\floatstyle{plain}
\newfloat{lstfloat}{htbp}{lop}[chapter]
\floatname{lstfloat}{Listing}
\def\lstfloatautorefname{Listing} % needed for hyperref/auroref

% Listing style
\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}

\lstdefinestyle{mystyle}{
    backgroundcolor=\color{backcolour},
    commentstyle=\color{codegreen},
    keywordstyle=\color{blue},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{codepurple},
    basicstyle=\fontsize{7}{10}\selectfont,
    breakatwhitespace=false,
    breaklines=false,
    captionpos=b,
    keepspaces=true,
    numbers=left,
    numbersep=5pt,
    showspaces=false,
    showstringspaces=false,
    showtabs=false,
    tabsize=2
}

\lstset{style=mystyle}

\makeatletter
\newcommand*{\shifttext}[2]{%
  \settowidth{\@tempdima}{#2}%
  \makebox[\@tempdima]{\hspace*{#1}#2}%
}
\makeatother

\usepackage{pythonhighlight}

% Appendices
\usepackage[toc,page]{appendix}

% Headers and footers
\usepackage{fancyhdr}
% \renewcommand{\chaptermark}[1]{\markboth{\thechapter.\ #1}{}}
% \renewcommand{\sectionmark}[1]{\markright{\thesection.\ #1}}

% \fancypagestyle{plain}{
% \fancyhf{}
% \fancyhead{}% remove default header entries
% \fancyhead[RE]{a\textsc{\leftmark}}
% \fancyhead[LE]{\thepage}
% \fancyhead[LO]{\textsc{\rightmark}}
% \fancyhead[RO]{\thepage}
% \renewcommand{\headrulewidth}{0.1pt} }
% \pagestyle{plain}

\fancypagestyle{firststyle}
{
   \fancyhf{}
    \fancyhead{}% remove default header entries
   \fancyfoot[C]{Porto, July 2022}
   \renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0.1pt}
    \fancyfootoffset{-0.25\textwidth}
}

\pagestyle{fancy}
\fancyhf{}
\renewcommand{\chaptermark}[1]{\markboth{\thechapter.\ #1}{}}
\renewcommand{\sectionmark}[1]{\markright{\thesection.\ #1}}
\fancyhead{}% remove default header entries
\fancyhead[RE]{\nouppercase\leftmark}
\fancyhead[LE]{\thepage}
\fancyhead[LO]{\nouppercase\rightmark}
\fancyhead[RO]{\thepage}
\renewcommand{\headrulewidth}{0.1pt}

\newenvironment{dedication}
  {%\clearpage           % we want a new page          %% I commented this
   \thispagestyle{empty}% no header and footer
   \vspace*{\stretch{1}}% some space at the top
   \itshape             % the text is in italics
   \raggedleft          % flush to the right margin
  }
  {\par % end the paragraph
   \vspace{\stretch{3}} % space at bottom is three times that at the top
   \clearpage           % finish off the page
  }


% landscape
% \usepackage{lscape}
\usepackage{pdflscape}

%Custom FramedBox Environment
%%Loading 'float' package
\usepackage{float}
%%Customize 'boxed' float style (caption above the body)
\makeatletter
\newcommand\fs@boxedtop
 {\fs@boxed
  \def\@fs@mid{\vspace\abovecaptionskip\relax}%
  \let\@fs@iftopcapt\iftrue
 }
\makeatother
%%Defining float commands
\floatstyle{boxedtop}
\floatname{framedbox}{Box}
\newfloat{framedbox}{hbt}{lob}[chapter]

% Symbols
%% Differential Upright "d"
\newcommand{\ud}{\,\mathrm{d}}
%% Assemble operator
\DeclareMathOperator*{\assemble}{\text{\Large $ \mathsf{A} $}}
%% Matrices and vectors
\newcommand{\vect}[1]{\bm{#1}}
\newcommand{\mat}[1]{\bm{#1}}
\newcommand{\boldsf}[1]{\boldsymbol{\mathsf{#1}}}

\DeclareMathAlphabet{\pazocal}{OMS}{zplm}{m}{n}

\title{Thermomechanial modeling of semi-crystalline polymers}
\author{José Luís Passos Vila-Chã}
\date{February 2023}

\pagenumbering{roman}

%Hypertext marks
\usepackage[pdftitle={PRODEM_seminar},
			pdfauthor={JoseVila-Cha},
			pdfdisplaydoctitle=true,
			colorlinks=true,
			% Eletronic Version
             linkcolor=orange,
             citecolor=teal,
            % Print Version
            % linkcolor=black,
            % citecolor=black,
            bookmarks=true,
            bookmarksopen=false,
            bookmarksnumbered=true]{hyperref}

\usepackage[intoc]{nomencl}
\usepackage{xstring}
\usepackage{xpatch}
\patchcmd{\thenomenclature}
  {\leftmargin\labelwidth}
  {\leftmargin\labelwidth\itemindent 1em }
  {}{}

% Nomenclature

\makenomenclature
\renewcommand{\nomname}{Notation}
%% This code creates the groups
% -----------------------------------------
\usepackage{etoolbox}
\newcommand{\nomenclheader}[1]{%
  \item[\hspace*{-\itemindent}\bfseries\LARGE#1\vphantom{$\Bigg \vert $}]}
\renewcommand\nomgroup[1]{%
  \IfStrEqCase{#1}{%
   {A}{\nomenclheader{General abbreviations}}%      A - Acronyms
   {N}{\nomenclheader{General notation}}% R - Roman
   {O}{\nomenclheader{Operators and symbols}}% G - Greek
   {D}{\nomenclheader{Sets, domains and boundaries}}% G - Greek
   {S}{\nomenclheader{Subscripts and superscripts}}%  S - Superscripts
   {C}{\nomenclheader{Accents}}%    U - Subscripts
   {V}{\nomenclheader{Variables}}% X - Other Symbols
  }%
  \vspace{20pt}
}
\setlength{\nomitemsep}{-1pt}
% -----------------------------------------

\begin{document}
\begin{titlepage}
\thispagestyle{firststyle}
\begin{center}
   \begin{minipage}[c][10cm][l]{0.9\textwidth}

        \includegraphics[width=0.6\textwidth]{figures/university}

        \vspace{3.5cm}
        \huge
       \textbf{Thermomechanical modeling of semi-crystalline polymers}

       \vspace{1.5cm}
        \small
       \textit{Professor:}\\
       \normalsize
       Renato Manuel Natal Jorge 	 	\\

       \vspace{0.5cm}


         \small
        \textit{Student:}\\
        \vspace{0.5cm}
       \normalsize
       \!José Luís Passos Vila-Chã
       \vspace{7.5cm}


        \centering
        \small
       Report presented under the scope of the\\ Doctoral Program in Mechanical Engineering

   \end{minipage}
   \end{center}
\end{titlepage}

\newpage\null\thispagestyle{blank}\newpage
\chapter*{Abstract}
\addcontentsline{toc}{chapter}{Abstract}

Nowadays, the design and modeling of advanced materials calls for the understanding that these are hierarchical in nature, i.e. their macroscopic properties and mechanical response result from the interaction between heterogeneous structures spanning over multiple length scales.
Examples of important materials from an industrial standpoint that benefit from this multi-scale approach are polymer blends and composite materials.
In this view, the method of computational homogenization emerged as an effective way of modeling multi-scale heterogeneous materials by performing an homogenization procedure over a representative volume element (RVE) of the microstructure.
However, in order to accurately capture the macroscopic behavior, it is crucial that the RVE contains enough morphological and topological information about the microstructural heterogeneities and is representative in an average sense.

This work presents a computational robust and efficient program in Python, based on a molecular dynamics simulation with a multi-temperature isokinetic scheme, that is able to generate an RVE from a given set of material and geometrical input descriptors.
In general, these may characterize the material matrix, particles/inclusions, voids and fibers, e.g. radius, ellipsoid axes magnitude and orientation, spatial position, and the corresponding phase in the heterogeneous material, volume fraction and number of particles.
The geometrical parameters characterizing the inclusions may be specified by the user as fixed values or be made to vary according to different statistical distributions.
Multiple phases are also supported allowing for great flexibility in the modeling of real materials.

The microstructures generated are evaluated using the Minkowski structure metrics of their Voronoi cells.
These are a very versatile tool in the detection of unwanted order or clustering, both undesirable properties in a microstructure whose purpose is to plausibly mimic real matrix-composite materials.
Using this technique, the microstructures generated through the proposed approach are validated as it pertains to their "quality".

After the generation procedure, various RVEs are discretized in a suitable finite element mesh in order to perform microscale analyses through computational homogenization.
The various examples considered are created keeping the volume fraction constant and increasing the number of inclusions within the RVE.
Submitting the microstructures to various loading conditions and employing different boundary conditions, it is concluded that an increase in the number of particles included leads to a more representative volume element.
Isotropic responses are also achieved for microstructures containing only Disks and Spheres, as more inclusions are considered.

\newpage\null\thispagestyle{blank}\newpage

\chapter*{Resumo}
\addcontentsline{toc}{chapter}{Resumo}

Nos dias de hoje, o projeto e modelação de materiais avançados exige a perceção de que estes são compostos por estruturas hierárquicas, isto é, as suas propriedades ma\-cros\-có\-pi\-cas e a sua resposta mecânica resultam da interação entre estruturas heterogéneas que se apresentam a múltiplas escalas.
Materiais de grande importância a nível industrial que beneficiam deste tipo de análise a várias escalas são, por exemplos, as misturas de polímeros e os materiais compósitos.
Nesta perspetiva, o método da homogeneização computacional surgiu como uma técnica eficaz de modelar materiais heterogéneos a múltiplas escalas, através de um procedimento de homogeneização ao longo de um elemento de volume representativo (RVE) da microestrutura.
Todavia, de modo a capturar com precisão o seu comportamento macroscópico é crucial que o RVE contenha um conjunto de informação morfológica e topológica sobre as heterogeneidades à micro escala, sendo representativo do comportamento do material em média.

Esta tese apresenta um programa computacionalmente robusto e eficiente, escrito em Python, baseado em simulações de dinâmica molecular com esquema isocinético multi temperatura, que é capaz de gerar RVEs a partir de um conjunto de descritores materiais de geométricos de entrada.
Em geral, estes podem caraterizar a matriz do material, as sua inclusões, vazios ou fibras, especificando, por exemplo, o raio das partículas, e a fase correspondente, através da sua fração volúmica e numero de inclusões.
Dado que um número arbitrário de fases é permitido, obtém-se uma ferramenta muito flexível na modelação de materiais reais.

As microestruturas geradas são avaliadas utilizando as métricas estruturais de Min\-kow\-ski das suas células Voronoi.
Estas são uma ferramenta versátil na deteção de estruturas ordenadas ou aglomerados indesejáveis de partículas, ambas caraterísticas inconvenientes em microestruturas cujo propósito é imitar de forma plausível materiais compósitos reais.
Utilizando esta técnica, validaram-se as microestruturas geradas através da abordagem proposta quanto à sua "qualidade".

Depois de gerados, discretizaram-se vários RVEs em malhas de elementos finitos apropriadas com o objetivo de levar a cabo análises à micro escala por homogeneização computacional.
Os vários exemplos considerados são criados mantendo a fração volúmica constante, mas aumentando o número de inclusões dentro do RVE.
Concluí-se, submetendo as microestruturas a vários esquemas de carregamento mediante diferentes condições fronteira, que um aumento no número de partículas incluídas leva a um volume elementar mais representativo.
Verificam-se ainda respostas isotrópicas por parte de microestruturas que contêm apenas Discos e Esferas, à medida que mais inclusões são consideradas.

\newpage\null\thispagestyle{blank}\newpage

\chapter*{Acknowledgments}
\addcontentsline{toc}{chapter}{Acknowledgments}

I wish to thank both my supervisors, Prof. Francisco Pires and Bernardo Ferreira for their guidance and help during this work.
I hope to have fulfilled the goals set forth for this MSc thesis and to have meaningfully contributed to the work developed by the CM2S group.

I am profoundly thankful for all the support and encouragement from my parents and my brother.
All my achievements, big and small, in the journey that lead me here can be traced to their unwavering belief in me.

To all the CM2S work group, I wish to express a sincere "thank you" for all the help you provided me.

\newpage\null\thispagestyle{blank}\newpage

\setcounter{tocdepth}{2}
\tableofcontents

\newpage\null\thispagestyle{blank}\newpage

\listoffigures

\newpage\null\thispagestyle{blank}\newpage

\listoftables

\newpage\null\thispagestyle{blank}\newpage


\nomenclature[A]{BVP}{\textbf Boundary \textbf Value \textbf Problem}
\nomenclature[A]{DOF}{\textbf Degrees \textbf Of \textbf Freedom}
\nomenclature[A]{FEM}{\textbf Finite \textbf Element \textbf Method}
\nomenclature[A]{PMVP}{\textbf Principle of \textbf Multi-scale \textbf Virtual \textbf Power}

\nomenclature[A]{RVE}{\textbf Representative \textbf Volume \textbf Element}

\nomenclature[N, 01]{$a$}{Scalar}
\nomenclature[N, 02]{$\vect a$}{First order tensor}
\nomenclature[N, 03]{$\mat A$}{Second order tensor}
\nomenclature[N, 04]{$\mathbf a$}{Finite Element Method vector}
\nomenclature[N, 05]{$\mathbf A$}{Finite Element Method matrix}
\nomenclature[N, 06]{$\mathcal A$}{Body, space or set}

\nomenclature[O]{$\ud(\cdot)$}{Infinitesimal}
\nomenclature[O]{$\partial(\cdot)/\partial a$}{Partial derivative with respect to $a$}
\nomenclature[O]{$\mathrm{div}_0(\cdot)$}{Material divergence operator}
\nomenclature[O]{$\nabla(\cdot)$}{Spatial gradient operator}
\nomenclature[O]{$\nabla_0(\cdot)$}{Material gradient operator}
\nomenclature[O]{$\mathrm{det}(\cdot)$}{Determinant}
\nomenclature[O]{$\ln(\cdot)$}{Natural logarithm}
\nomenclature[O]{$\mathrm{tr}(\cdot)$}{Matrix trace}
\nomenclature[O]{$\|(\cdot)\|$}{Euclidean norm}
\nomenclature[O]{$(\cdot)\otimes(\cdot)$}{Tensorial product}
\nomenclature[O]{$(\cdot)\cdot(\cdot)$}{Tensorial dot product}
\nomenclature[O]{$(\cdot):(\cdot)$}{Tensorial double contraction}
\nomenclature[O]{$(\cdot)*(\cdot)$}{Appropriate product}
\nomenclature[O]{$\mat I$}{Second order identity tensor}
\nomenclature[O]{$\assemble (\cdot)$}{Finite Element Method assembly operator}
\nomenclature[O]{$\delta(\cdot)$}{Variation}
\nomenclature[O]{$\langle(\cdot)\rangle$}{Ensemble average}

% Accents
\nomenclature[C, 01]{$\dot{(\cdot)}$}{First order time derivative}
\nomenclature[C, 02]{$\ddot{(\cdot)}$}{Second order time derivative}
\nomenclature[C, 03]{$\widehat{(\cdot)}$}{Incremental constitutive function}

% Sets, domains and boundaries
\nomenclature[D, 01]{$\mathcal E$}{Euclidean space}
\nomenclature[D, 02]{$\mathscr K$}{Set of kinematically admissible macroscopic displacements}
\nomenclature[D, 03]{$\mathscr K_\mu$}{Set of kinematically admissible minimally constrained microscopic displacements}
\nomenclature[D, 04]{$\tilde{\mathscr K}_\mu$}{Set of kinematically admissible minimally constrained microscopic displacements fluctuations}
\nomenclature[D, 05]{$\mathscr V$}{Set of virtual displacements}
\nomenclature[D, 06]{$\mathscr V_\mu$}{Set of virtual displacements fluctuations}
\nomenclature[D, 07]{$\upsilon$}{Local (or natural) normalized domain}
\nomenclature[D, 08]{$\Omega$}{Body domain in current configuration}
\nomenclature[D, 09]{$\partial \Omega$}{Body domain boundary in current configuration}
\nomenclature[D, 10]{$\Omega_0$}{Body domain in reference configuration}
\nomenclature[D, 11]{$\partial \Omega_0$}{Body domain boundary in reference configuration}
\nomenclature[D, 12]{$\Omega_\mu$}{RVE domain in current configuration}
\nomenclature[D, 13]{$\partial \Omega_\mu$}{RVE domain boundary in current configuration}
\nomenclature[D, 14]{$\Omega_{\mu,0}$}{RVE domain in reference configuration}
\nomenclature[D, 15]{$\partial \Omega_{\mu,0}$}{RVE domain boundary in reference configuration}

% Subscripts and superscripts
\nomenclature[S]{$(\cdot)^{(e)}$}{Elemental quantity}
\nomenclature[S]{$(\cdot)^{(0)}$}{Reference material related quantity}
\nomenclature[S]{$(\cdot)^{g}$}{Global quantity}
\nomenclature[S]{$(\cdot)_0$}{Reference configuration, initial time}
\nomenclature[S]{$(\cdot)_\mu$}{Microscale related quantity}
\nomenclature[S]{${}^h(\cdot)$}{Discretized domain, interpolated field}
\nomenclature[S]{$(\cdot)_d$}{Deviatoric component}
\nomenclature[S]{$(\cdot)_h$}{Hydrostatic component}
\nomenclature[S]{$(\cdot)_u$}{Quantity in the mechanical problem}
\nomenclature[S]{$(\cdot)_T$}{Quantity in the thermal problem}


\printnomenclature

\newpage\null\thispagestyle{blank}\newpage

\pagenumbering{gobble}
\pagenumbering{arabic}
\pagestyle{fancy}
\include{introduction}
\include{thermo_mechanical_problem_short}
\include{semi_crystalline_polymer_thermomechanical_behavior}
\include{state_of_the_art_modeling_semi_crystalline_polymers}
\include{numerical_results}
\include{conclusion}
\appendix
% \include{annex}

\bibliography{semi_crystalline_polymer.bib}

\end{document}
